<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<style>
			body {
				padding: 0;
				margin: 0;
			}

			.song-detail {
				padding: 10px;
			}
		</style>
	</head>
	<body>
		<h2>Create a custom playlist</h2>
		<button onClick="addSong();">Add Another Song</button>
		<button onClick="createPlaylist();">Create your playlist!</button>

		<script>
			var songDetail = '<div class="song-detail"> \
			<input type="text" placeholder="YouTube Song ID" name="song-id"> \
			<input type="text" placeholder="Start Time (sec)" name="start-time"> \
			<input type="text" placeholder="End Time (sec)" name="end-time"> \
			<button class="remove-song">remove</button> \
			</div>';

			function addSong() {
				var el = $(songDetail).appendTo('body');
				el.find('.remove-song').on('click', function() {
					$(this).parent().remove();
				});
			}

			function createPlaylist() {
				// convert the inputs to json song list
				var songList = [];
				$('.song-detail').each(function() {
					var song = {
						id: $(this).find('[name="song-id"]').val()
					};
					
					var startTime = parseInt($(this).find('[name="start-time"]').val()) || undefined;
					var endTime = parseInt($(this).find('[name="end-time"]').val()) || undefined;
					if (startTime) {
						song.startTime = startTime;
					}
					if (endTime) {
						song.endTime = endTime;
					}

					songList.push(song);
				});

				window.localStorage.setItem('songList', JSON.stringify(songList));
				window.location.href = './crossfade.html'
			}

			addSong();
		</script>
	</body>
</html>